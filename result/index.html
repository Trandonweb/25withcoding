<script>
const sidebar = document.getElementById("sidebar");
const hamburger = document.getElementById("hamburger");

hamburger.addEventListener("click", function(e){
  e.stopPropagation();
  sidebar.classList.toggle("open");
});

sidebar.addEventListener("click", function(e){
  e.stopPropagation();
});

document.addEventListener("click", function(){
  sidebar.classList.remove("open");
});

/* ===================== */
/* ê²°ê³¼ í™•ì¸ ë¡œì§ */

const releaseDate = new Date("2026-01-01T00:00:00");

/* ğŸ”¥ ì‹¤ì œ CSV ë§í¬ + ìºì‹œ ë°©ì§€ìš© ê¸°ë³¸ URL */
const sheetURL =
"https://docs.google.com/spreadsheets/d/1UN0VBv_xf6ZA8i66MsVExqVysarT44hwg_Gqqk1EZT4/export?format=csv&gid=0";

if(new Date() < releaseDate){
  document.getElementById("beforeMessage").style.display = "block";
  document.getElementById("beforeMessage").innerText =
    "2026ë…„ 1ì›” 1ì¼ê¹Œì§€ëŠ” ê²°ê³¼ í™•ì¸ ê¸°ê°„ì´ ì•„ë‹™ë‹ˆë‹¤.";
  document.getElementById("formArea").style.display = "none";
}

async function checkResult(){
  const studentId = document.getElementById("studentId").value.trim();
  const name = document.getElementById("name").value.trim();
  const resultBox = document.getElementById("result");

  if(!studentId || !name){
    resultBox.innerText = "í•™ë²ˆê³¼ ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.";
    return;
  }

  try{

    /* ğŸ”¥ ìºì‹œ ë°©ì§€ (ì™„ì „ ì‹¤ì‹œê°„ ë³´ì¥) */
    const response = await fetch(sheetURL + "&t=" + new Date().getTime());

    const data = await response.text();
    const rows = data.split("\n").slice(1);

    let found = false;

    for(let row of rows){
      const cols = row.split(",");
      const sheetStudentId = cols[1]?.trim();
      const sheetName = cols[2]?.trim();
      const status = cols[4]?.trim();

      if(sheetStudentId === studentId && sheetName === name){
        found = true;
        resultBox.innerText =
          status === "í•©ê²©" ? "ğŸ‰ í•©ê²©ì…ë‹ˆë‹¤!" : "ì•„ì‰½ì§€ë§Œ ë¶ˆí•©ê²©ì…ë‹ˆë‹¤.";
        break;
      }
    }

    if(!found){
      resultBox.innerText = "ì¼ì¹˜í•˜ëŠ” ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";
    }

  }catch(error){
    resultBox.innerText = "ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
    console.error(error);
  }
}
</script>
